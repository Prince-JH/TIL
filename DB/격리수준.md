# 격리수준

## 종류
- SERIALIZABLE: 특정 트랜잭션이 사용중인 테이블의 모든 행을 다른 트랜잭션이 접근할 수 없도록 잠근다. 가장 높은 데이터 정합성을 갖으나, 성능은 가장 떨어진다. 이 격리 수준에서는 단순한 SELECT 쿼리가 실행되더라도, 데이터베이스 락이 걸려 다른 트랜잭션에서 데이터에 접근할 수 없게된다.
- REPEATABLE READ: 트랜잭션이 시작되기 전에 커밋된 내용에 대해서만 조회할 수 있는 격리수준이다. 즉, 간단하게 말해서 자신의 트랜잭션 번호보다 낮은 트랜잭션 번호에서 변경된(+커밋된) 것만 보게 되는 것이다. -> 특정 레코드에 대해 다른 결과를 얻는 **Non-Repeatable Read**는 발생하지 않는다.
- READ COMMITED: 커밋이 완료된 트랜잭션의 변경사항만 다른 트랜잭션에서 조회할 수 있도록 허용하는 격리 수준이다. 가장 많이 사용되는 격리 수준이며, Postgresql 등에서 기본값으로 설정되어있다. 한 트랜잭션 내에서 같은 레코드를 두 번 읽을 때, 그 사이에 다른 트랜잭션에 의해 해당 레코드가 변경되면 첫 번째 조회와 두 번째 조회가 다른 값을 반환하는 **Non-Repeatable Read**가 발생할 수 있다.
- READ UNCOMMITED: 커밋이 되지 않은 트랜잭션의 데이터 변경 내용을 다른 트랜잭션이 조회하는 것을 허용하는 격리 수준이다. 데이터 부정합 문제가 발생할 확률이 높지만, 성능은 가장 빠르다. 데이터를 어림잡아 집계하는 등의 연산에서 사용하면 좋다.

## Non-Repeatable Read vs Phantom Read
Non-Repeatable Read는 **특정 레코드**에 대해 발생하는 현상. 한 트랜잭션 내에서 같은 레코드를 두 번 읽을 때, 그 사이에 다른 트랜잭션에 의해 해당 레코드가 변경되면 첫 번째 조회와 두 번째 조회가 다른 값을 반환한다. 즉, 레코드의 값이 변경되어 일관성이 깨진다.

Phantom Read는 **레코드 집합**에 대해 발생하는 현상. 한 트랜잭션 내에서 쿼리를 두 번 실행할 때, 첫 번째 쿼리와 두 번째 쿼리 사이에 다른 트랜잭션에 의해 새로운 레코드가 추가되거나 삭제됨으로써 결과 집합 자체가 변경된다. 즉, 처음에는 없던 레코드가 나타나거나, 있던 레코드가 사라져서 쿼리 결과의 일관성이 깨진다.
